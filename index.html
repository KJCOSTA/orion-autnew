<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ORION SYSTEM | V7 Blue Nebula</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Outfit:wght@200;300;400;500;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="orion_db.js" onerror="console.warn('DB não encontrado, usando fallback interno.')"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        void: '#02040a',
                        glass: 'rgba(10, 20, 40, 0.7)',
                        cyan: '#00f2ff',
                        deepBlue: '#1e3a8a',
                        gold: '#fbbf24',
                        alert: '#ef4444'
                    },
                    fontFamily: {
                        serif: ['Cinzel', 'serif'],
                        sans: ['Outfit', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    animation: {
                        'pulse-glow': 'pulseGlow 3s infinite',
                        'scanline': 'scanline 8s linear infinite',
                    },
                    keyframes: {
                        pulseGlow: {
                            '0%, 100%': { boxShadow: '0 0 5px rgba(0, 242, 255, 0.2)' },
                            '50%': { boxShadow: '0 0 20px rgba(0, 242, 255, 0.6)' },
                        },
                        scanline: {
                            '0%': { transform: 'translateY(-100%)' },
                            '100%': { transform: 'translateY(100%)' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* --- BACKGROUND FX --- */
        body {
            background-color: #02040a;
            color: #e2e8f0;
            overflow: hidden;
            /* O Gradiente Azul Profundo que você queria */
            background-image: 
                radial-gradient(circle at 50% 0%, #172554 0%, #02040a 60%),
                radial-gradient(circle at 85% 30%, rgba(0, 242, 255, 0.05) 0%, transparent 40%),
                radial-gradient(circle at 15% 80%, rgba(251, 191, 36, 0.05) 0%, transparent 40%);
        }

        /* GRID OVERLAY */
        .bg-grid {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none; z-index: -1;
            mask-image: radial-gradient(circle at center, black, transparent 80%);
        }

        /* GLASS CARD (PELÍCULA DE VIDRO) */
        .glass-panel {
            background: rgba(8, 14, 28, 0.6);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-top: 1px solid rgba(255, 255, 255, 0.2); /* Borda de luz superior */
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .glass-panel:hover {
            border-color: rgba(0, 242, 255, 0.3);
            box-shadow: 0 0 20px rgba(0, 242, 255, 0.1);
        }

        /* TEXT GLOWS */
        .glow-cyan { text-shadow: 0 0 10px rgba(0, 242, 255, 0.7); }
        .glow-gold { text-shadow: 0 0 10px rgba(251, 191, 36, 0.7); }

        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #02040a; }
        ::-webkit-scrollbar-thumb { background: #1e3a8a; border-radius: 3px; }

        /* NAVIGATION */
        .nav-item { transition: all 0.3s; border-left: 3px solid transparent; }
        .nav-item.active { background: linear-gradient(90deg, rgba(0, 242, 255, 0.1), transparent); border-left-color: #00f2ff; color: #fff; }
        .nav-item:hover:not(.active) { background: rgba(255, 255, 255, 0.03); }

    </style>
</head>
<body class="h-screen flex text-sm selection:bg-cyan selection:text-black">

    <div class="bg-grid"></div>

    <aside class="w-72 flex-shrink-0 flex flex-col border-r border-white/5 bg-void/80 backdrop-blur-md z-20">
        <div class="h-20 flex items-center px-6 border-b border-white/5 relative overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-r from-deepBlue/30 to-transparent"></div>
            <div class="relative z-10">
                <h1 class="font-serif text-3xl text-transparent bg-clip-text bg-gradient-to-r from-gold to-amber-600 font-bold tracking-widest drop-shadow-sm">ORION</h1>
                <div class="flex items-center gap-2 mt-1">
                    <div class="w-1.5 h-1.5 bg-cyan rounded-full animate-pulse"></div>
                    <span class="text-[10px] font-mono text-cyan/80 tracking-[0.3em] uppercase">System Online</span>
                </div>
            </div>
        </div>

        <nav class="flex-1 py-6 px-3 space-y-1 overflow-y-auto">
            <div class="px-3 mb-2 text-[10px] font-mono text-slate-500 uppercase tracking-widest">Controle Principal</div>
            
            <button onclick="router('dashboard')" id="nav-dashboard" class="nav-item active w-full flex items-center gap-3 px-4 py-3 text-slate-400 rounded-r-lg group">
                <i class="fa-solid fa-chart-pie w-5 text-center group-hover:text-cyan transition-colors"></i>
                <span class="font-medium">Dashboard Geral</span>
            </button>

            <button onclick="router('inventory')" id="nav-inventory" class="nav-item w-full flex items-center gap-3 px-4 py-3 text-slate-400 rounded-r-lg group">
                <i class="fa-solid fa-server w-5 text-center group-hover:text-cyan transition-colors"></i>
                <span class="font-medium">Banco de Dados</span>
            </button>

            <button onclick="router('timeline')" id="nav-timeline" class="nav-item w-full flex items-center gap-3 px-4 py-3 text-slate-400 rounded-r-lg group">
                <i class="fa-solid fa-clock-rotate-left w-5 text-center group-hover:text-gold transition-colors"></i>
                <span class="font-medium">Linha do Tempo</span>
            </button>

            <div class="px-3 mt-6 mb-2 text-[10px] font-mono text-slate-500 uppercase tracking-widest">Inteligência</div>
            
            <button class="nav-item w-full flex items-center gap-3 px-4 py-3 text-slate-600 rounded-r-lg cursor-not-allowed opacity-70">
                <i class="fa-solid fa-brain w-5 text-center"></i>
                <span>Gemini Core (Locked)</span>
            </button>
        </nav>

        <div class="p-4 border-t border-white/5 bg-black/20">
            <div class="flex justify-between text-[10px] font-mono text-slate-500 mb-1">
                <span>RAM USAGE</span>
                <span class="text-cyan">4.2 GB</span>
            </div>
            <div class="w-full bg-slate-800 h-1 rounded-full overflow-hidden">
                <div class="bg-gradient-to-r from-cyan to-blue-600 h-full w-[35%]"></div>
            </div>
            <div class="mt-2 text-[10px] text-slate-600 text-center font-mono">
                AutNew Engineer v7.0
            </div>
        </div>
    </aside>

    <main class="flex-1 flex flex-col relative z-10 overflow-hidden bg-void/30">
        
        <header class="h-16 border-b border-white/5 bg-void/50 backdrop-blur-sm flex justify-between items-center px-8">
            <div class="flex items-center gap-6">
                <div class="flex flex-col">
                    <span class="text-[10px] font-mono text-slate-500 uppercase tracking-widest">Fase Atual</span>
                    <span class="text-white font-bold tracking-wide">1. ORGANIZAÇÃO</span>
                </div>
                <div class="h-6 w-px bg-white/10"></div>
                <div class="flex flex-col">
                    <span class="text-[10px] font-mono text-slate-500 uppercase tracking-widest">Status Core</span>
                    <span class="text-alert font-bold tracking-wide flex items-center gap-2">
                        <i class="fa-solid fa-lock text-[10px]"></i> INEXISTENTE
                    </span>
                </div>
            </div>
            
            <div class="flex items-center gap-4">
                <div class="text-right">
                    <div class="text-lg font-mono text-cyan glow-cyan" id="clock">00:00:00</div>
                </div>
            </div>
        </header>

        <div id="app-view" class="flex-1 overflow-y-auto p-8 scroll-smooth">
            </div>

    </main>

    <script>
        // --- DATA LAYER ---
        // Se o arquivo externo não carregar, usa este padrão
        const DEFAULT_DB = {
            kpis: { progresso: 0, total_arquivos: 0, decisoes_registradas: 0, status_core: "OFF" },
            arquivos: [],
            timeline: [],
            grafico: { labels: [], dados: [] }
        };

        const DB = window.ORION_DB || DEFAULT_DB;

        // --- ROUTER & RENDERER ---
        function router(view) {
            // Update Menu
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            document.getElementById('nav-' + view).classList.add('active');

            const container = document.getElementById('app-view');
            container.innerHTML = ''; // Clear
            container.style.opacity = 0;

            if (view === 'dashboard') renderDashboard(container);
            if (view === 'inventory') renderInventory(container);
            if (view === 'timeline') renderTimeline(container);

            // Fade In
            setTimeout(() => container.style.opacity = 1, 50);
            container.style.transition = 'opacity 0.3s ease-out';
        }

        function renderDashboard(container) {
            container.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="glass-panel p-6 rounded-xl border-t-2 border-t-cyan">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-[10px] font-mono text-slate-400 uppercase tracking-widest">Progresso Fase 1</span>
                            <i class="fa-solid fa-bars-progress text-cyan/50"></i>
                        </div>
                        <div class="text-3xl font-light text-white mb-2">${DB.kpis.progresso}%</div>
                        <div class="w-full bg-slate-800 h-1 rounded-full overflow-hidden">
                            <div class="bg-cyan h-full shadow-[0_0_10px_#00f2ff]" style="width: ${DB.kpis.progresso}%"></div>
                        </div>
                    </div>

                    <div class="glass-panel p-6 rounded-xl border-t-2 border-t-blue-600">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-[10px] font-mono text-slate-400 uppercase tracking-widest">Total Arquivos</span>
                            <i class="fa-solid fa-server text-blue-500/50"></i>
                        </div>
                        <div class="text-3xl font-light text-white mb-2">${DB.kpis.total_arquivos.toLocaleString()}</div>
                        <div class="text-[10px] text-slate-500">Mapeamento Drive + Local</div>
                    </div>

                    <div class="glass-panel p-6 rounded-xl border-t-2 border-t-gold">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-[10px] font-mono text-slate-400 uppercase tracking-widest">Decisões</span>
                            <i class="fa-solid fa-gavel text-gold/50"></i>
                        </div>
                        <div class="text-3xl font-light text-white mb-2">${DB.kpis.decisoes_registradas}</div>
                        <div class="text-[10px] text-slate-500">Registradas no Core</div>
                    </div>

                    <div class="glass-panel p-6 rounded-xl border-t-2 border-t-alert">
                        <div class="flex justify-between items-start mb-2">
                            <span class="text-[10px] font-mono text-slate-400 uppercase tracking-widest">Core Status</span>
                            <i class="fa-solid fa-shield-halved text-alert/50"></i>
                        </div>
                        <div class="text-2xl font-bold text-alert mb-2">${DB.kpis.status_core}</div>
                        <div class="text-[10px] text-alert/70 border border-alert/20 px-2 py-1 rounded inline-block">BLOQUEIO ATIVO</div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="glass-panel p-6 rounded-xl col-span-2">
                        <h3 class="font-serif text-white mb-6 border-b border-white/5 pb-2">Distribuição de Dados</h3>
                        <div class="h-64 w-full relative">
                            <canvas id="mainChart"></canvas>
                        </div>
                    </div>

                    <div class="glass-panel p-0 rounded-xl overflow-hidden flex flex-col">
                        <div class="p-4 bg-white/5 border-b border-white/5 flex justify-between items-center">
                            <span class="font-serif text-white">System Feed</span>
                            <div class="flex gap-1">
                                <div class="w-1.5 h-1.5 rounded-full bg-cyan animate-pulse"></div>
                            </div>
                        </div>
                        <div class="p-4 flex-1 overflow-y-auto space-y-4 max-h-64">
                            ${DB.timeline.slice(0, 5).map(log => `
                                <div class="flex gap-3 items-start group">
                                    <div class="text-[10px] font-mono text-slate-500 mt-1">${log.hora}</div>
                                    <div class="text-xs text-slate-300 border-l border-white/10 pl-3 group-hover:border-cyan transition-colors">
                                        <div class="font-bold text-cyan mb-0.5">${log.tipo}</div>
                                        ${log.msg}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            setTimeout(initChart, 50);
        }

        function renderInventory(container) {
            container.innerHTML = `
                <div class="glass-panel rounded-xl overflow-hidden min-h-[500px] flex flex-col">
                    <div class="p-6 border-b border-white/5 flex justify-between items-center">
                        <h2 class="font-serif text-xl text-white">Inventário de Arquivos</h2>
                        <div class="relative">
                            <input type="text" id="search" onkeyup="filterTable()" placeholder="Filtrar dados..." class="bg-black/50 border border-white/10 rounded px-4 py-2 text-xs text-cyan focus:border-cyan outline-none w-64">
                        </div>
                    </div>
                    <div class="overflow-x-auto flex-1">
                        <table class="w-full text-left border-collapse">
                            <thead class="bg-white/5 text-[10px] uppercase font-mono text-slate-500">
                                <tr>
                                    <th class="p-4">Nome do Arquivo</th>
                                    <th class="p-4">Tipo</th>
                                    <th class="p-4">Caminho / Local</th>
                                    <th class="p-4 text-right">Tag</th>
                                </tr>
                            </thead>
                            <tbody id="table-body" class="text-xs text-slate-300 divide-y divide-white/5 font-mono">
                                ${DB.arquivos.map(file => `
                                    <tr class="hover:bg-white/5 transition-colors group file-row">
                                        <td class="p-4 font-sans text-sm text-white font-medium group-hover:text-cyan transition-colors">${file.nome}</td>
                                        <td class="p-4"><span class="px-2 py-1 rounded bg-slate-800 border border-white/10 text-[10px]">${file.tipo}</span></td>
                                        <td class="p-4 text-slate-500 truncate max-w-xs">${file.caminho}</td>
                                        <td class="p-4 text-right"><span class="text-gold text-[10px] border border-gold/20 px-2 py-0.5 rounded">${file.tag}</span></td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderTimeline(container) {
            container.innerHTML = `
                <div class="glass-panel p-8 rounded-xl min-h-full">
                    <h2 class="font-serif text-xl text-white mb-8 border-b border-white/5 pb-4">Cronologia Completa</h2>
                    <div class="border-l border-white/10 ml-4 space-y-8">
                        ${DB.timeline.map(log => `
                            <div class="relative pl-8 group">
                                <div class="absolute -left-[5px] top-1.5 w-2.5 h-2.5 rounded-full bg-void border border-cyan group-hover:bg-cyan group-hover:shadow-[0_0_10px_#00f2ff] transition-all"></div>
                                <div class="text-[10px] font-mono text-cyan mb-1">${log.hora}</div>
                                <div class="text-sm text-white font-bold mb-1">${log.tipo}</div>
                                <div class="text-xs text-slate-400 bg-white/5 p-3 rounded border border-white/5 group-hover:border-white/20 transition-colors">
                                    ${log.msg}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function filterTable() {
            const val = document.getElementById('search').value.toLowerCase();
            document.querySelectorAll('.file-row').forEach(row => {
                row.style.display = row.innerText.toLowerCase().includes(val) ? '' : 'none';
            });
        }

        function initChart() {
            const ctx = document.getElementById('mainChart');
            if(!ctx) return;
            
            // Gradient Fill
            const gradient = ctx.getContext('2d').createLinearGradient(0, 0, 0, 300);
            gradient.addColorStop(0, 'rgba(0, 242, 255, 0.5)'); // Cyan
            gradient.addColorStop(1, 'rgba(0, 0, 0, 0)');

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: DB.grafico.labels,
                    datasets: [{
                        label: 'Arquivos',
                        data: DB.grafico.dados,
                        backgroundColor: gradient,
                        borderColor: '#00f2ff',
                        borderWidth: 1,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#64748b' } },
                        x: { grid: { display: false }, ticks: { color: '#94a3b8' } }
                    }
                }
            });
        }

        // Clock
        setInterval(() => {
            document.getElementById('clock').innerText = new Date().toLocaleTimeString('pt-BR');
        }, 1000);

        // Init
        router('dashboard');

    </script>
</body>
</html>
